<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Amber Palette - Aroma Mosaic</title>
  <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js"></script>
  <style>
    :root { --bg: #0b0c10; --panel: #1f2833; --text: #e9ecf1; }
    body { margin: 0; padding: 16px; font-family: sans-serif; background: var(--bg); color: var(--text); }
    .wrap { max-width: 600px; margin: 0 auto; padding-bottom: 40px; } 
    
    /* 修正箇所: header-controlsを削除し、lang-toggleをチャート内に配置するためのスタイルに変更 */
    .lang-toggle { 
      position: absolute; /* チャートの上に重ねる */
      top: 12px; 
      left: 12px; 
      z-index: 100; /* チャートより手前に表示 */
      display: flex; 
      background: rgba(34, 34, 34, 0.9); /* 少し透過させて馴染ませる */
      border-radius: 8px; 
      overflow: hidden; 
      border: 1px solid #555; 
      box-shadow: 0 2px 5px rgba(0,0,0,0.5);
    }
    .lang-opt { padding: 6px 12px; font-size: 11px; cursor: pointer; color: #aaa; font-weight: bold; transition: all 0.2s; letter-spacing: 1px; }
    .lang-opt.active { background: #666; color: #fff; }
    
    /* 修正箇所: position: relativeを追加 */
    #chart-container { 
      position: relative; 
      width: 100%; 
      aspect-ratio: 1 / 1; 
      background: #111; 
      border-radius: 8px; 
      margin-bottom: 20px; 
      box-shadow: 0 10px 30px rgba(0,0,0,0.8); 
      overflow: hidden; 
    }
    
    .empty-msg { text-align: center; height: 100%; display: flex; align-items: center; justify-content: center; color: #666; font-size: 14px; letter-spacing: 1px; }
    .tabs { display: flex; overflow-x: auto; gap: 8px; margin-bottom: 16px; padding-bottom: 8px; border-bottom: 1px solid #333; }
    .tab { padding: 8px 16px; border-radius: 20px; background: #2a2a2a; color: #aaa; border: 1px solid transparent; cursor: pointer; font-size: 12px; font-weight: bold; white-space: nowrap; transition: 0.2s; }
    .tab.active { background: #444; color: #fff; }
    .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; }
    @media (max-width: 480px){ .grid { grid-template-columns: repeat(2, 1fr); } }
    .btn { padding: 10px 4px; border-radius: 10px; background: var(--panel); border: 1px solid transparent; color: inherit; cursor: pointer; display: flex; flex-direction: column; justify-content: center; align-items: center; min-height: 70px; transition: 0.1s; text-align: center; }
    .btn:active { transform: translateY(2px); }
    .btn-main { font-size: 13px; font-weight: 800; margin-bottom: 4px; transition: 0.2s; }
    .btn-sub { font-size: 10px; opacity: 0.7; margin-bottom: 4px; transition: 0.2s; }
    .btn-dots { font-size: 11px; letter-spacing: 1px; color: #555; }
    .btn.selected { background: #333; }
    .actions { display: flex; gap: 12px; margin-top: 24px; }
    .action-btn { flex: 1; padding: 14px; border-radius: 8px; font-size: 14px; font-weight: bold; cursor: pointer; border: none; transition: 0.2s; display: flex; align-items: center; justify-content: center; gap: 8px; }
    .action-btn:active { transform: translateY(2px); }
    .btn-copy { background: #f4d03f; color: #111; }
    .btn-reset { background: #333; color: #e9ecf1; border: 1px solid #555; }
    .toast { position: fixed; bottom: -50px; left: 50%; transform: translateX(-50%); background: #4caf50; color: #fff; padding: 10px 20px; border-radius: 20px; font-size: 14px; font-weight: bold; transition: 0.3s; z-index: 1000; box-shadow: 0 4px 10px rgba(0,0,0,0.5); pointer-events: none; }
    .toast.show { bottom: 30px; }
  </style>
</head>
<body>
  <div class="toast" id="toast">Copied to clipboard!</div>
  <div class="wrap">
    <div id="chart-container">
      <div class="lang-toggle">
        <span class="lang-opt active" id="lang-en" onclick="setLang('en')">EN</span>
        <span class="lang-opt" id="lang-jp" onclick="setLang('jp')">JP</span>
      </div>
      <div class="empty-msg" id="emptyText">Tap flavors below to build profile</div>
    </div>

    <div class="tabs" id="tabContainer"></div>
    <div class="grid" id="btnGrid"></div>
    <div class="actions">
      <button class="action-btn btn-reset" onclick="resetData()"><span id="text-reset">Clear</span></button>
      <button class="action-btn btn-copy" onclick="copyData()"><span id="text-copy">Copy Data</span></button>
    </div>
  </div>

  <script>
    const whiskyFlavorData = {
      fruity:  [ { en: "Lemon", jp: "レモン" }, { en: "Orange", jp: "オレンジ" }, { en: "Green apple", jp: "青リンゴ" }, { en: "Red apple", jp: "赤リンゴ" }, { en: "Pear", jp: "洋梨" }, { en: "Peach", jp: "桃" }, { en: "Apricot", jp: "アプリコット" }, { en: "Cherry", jp: "チェリー" }, { en: "Banana", jp: "バナナ" }, { en: "Pineapple", jp: "パイナップル" }, { en: "Mango", jp: "マンゴー" }, { en: "Citrus peel", jp: "柑橘ピール" } ],
      floral:  [ { en: "Lavender", jp: "ラベンダー" }, { en: "Rose", jp: "ローズ" }, { en: "Violet", jp: "スミレ" }, { en: "Orange blossom", jp: "オレンジブロッサム" }, { en: "Jasmine", jp: "ジャスミン" }, { en: "Chamomile", jp: "カモミール" }, { en: "Honeysuckle", jp: "ハニーサックル" }, { en: "Lilac", jp: "ライラック" }, { en: "Geranium", jp: "ゼラニウム" }, { en: "Peony", jp: "ピオニー" }, { en: "Osmanthus", jp: "金木犀" }, { en: "Lily", jp: "ユリ" } ],
      woody:   [ { en: "Oak", jp: "オーク" }, { en: "Cedar", jp: "シダー" }, { en: "Sandalwood", jp: "白檀" }, { en: "Cinnamon", jp: "シナモン" }, { en: "Nutmeg", jp: "ナツメグ" }, { en: "Clove", jp: "クローブ" }, { en: "Tobacco", jp: "タバコ" }, { en: "Leather", jp: "レザー" }, { en: "Toasted oak", jp: "トーストオーク" }, { en: "Charred wood", jp: "チャーウッド" }, { en: "Dry timber", jp: "乾燥材" }, { en: "Resin", jp: "樹脂" } ],
      smoky:   [ { en: "Smoke", jp: "スモーク" }, { en: "Bonfire", jp: "焚き火" }, { en: "Ash", jp: "灰" }, { en: "Seaweed", jp: "海藻" }, { en: "Rocky shore", jp: "岩場" }, { en: "Damp earth", jp: "湿った土" }, { en: "Char", jp: "炭" }, { en: "Tar", jp: "タール" }, { en: "Medicinal", jp: "メディシナル" }, { en: "Disinfectant", jp: "消毒液" }, { en: "Iodine", jp: "ヨード" }, { en: "Peat smoke", jp: "ピートスモーク" } ],
      sweet:   [ { en: "Cream", jp: "クリーム" }, { en: "Honey", jp: "ハチミツ" }, { en: "Custard", jp: "カスタード" }, { en: "Vanilla", jp: "バニラ" }, { en: "Caramel", jp: "キャラメル" }, { en: "Butterscotch", jp: "バタースコッチ" }, { en: "Toffee", jp: "トフィー" }, { en: "Maple syrup", jp: "メープルシロップ" }, { en: "Brown sugar", jp: "三温糖" }, { en: "Chocolate", jp: "チョコレート" }, { en: "Marzipan", jp: "マジパン" }, { en: "Molasses", jp: "モラセス" } ],
      winey:   [ { en: "Plum", jp: "プラム" }, { en: "Red wine", jp: "赤ワイン" }, { en: "Berry jam", jp: "ベリージャム" }, { en: "Fig", jp: "イチジク" }, { en: "Raisin", jp: "レーズン" }, { en: "Prune", jp: "プルーン" }, { en: "Sherry", jp: "シェリー" }, { en: "Port", jp: "ポート" }, { en: "Oloroso", jp: "オロロソ" }, { en: "Walnut", jp: "くるみ" }, { en: "Rancio", jp: "ランシオ" }, { en: "PX", jp: "PX" } ],
      cereal:  [ { en: "Wheat", jp: "小麦" }, { en: "Green grain", jp: "未熟穀物" }, { en: "Corn", jp: "トウモロコシ" }, { en: "Malt", jp: "モルト" }, { en: "Sweet malt", jp: "甘い麦汁" }, { en: "Oatmeal", jp: "オートミール" }, { en: "Bread", jp: "パン" }, { en: "Biscuit", jp: "ビスケット" }, { en: "Yeast", jp: "酵母" }, { en: "Toast", jp: "トースト" }, { en: "Grain porridge", jp: "麦粥" }, { en: "Rye", jp: "ライ麦" } ],
      sulfury: [ { en: "Metallic", jp: "メタリック" }, { en: "Onion", jp: "玉ねぎ" }, { en: "Garlic", jp: "ニンニク" }, { en: "Boiled cabbage", jp: "茹でたキャベツ" }, { en: "Boiled egg", jp: "茹で卵" }, { en: "Rubber", jp: "ゴム" }, { en: "Struck match", jp: "擦ったマッチ" }, { en: "Gunpowder", jp: "火薬" }, { en: "Sulfur", jp: "硫黄" }, { en: "Smoke taint", jp: "スモークテイント" }, { en: "Tanned leather", jp: "鞣し革" }, { en: "Burnt rubber", jp: "焦げたゴム" } ]
    };

    const catConfig = {
      fruity: { en: "FRUITY", jp: "フルーティー", hex: "#f4d03f" },
      floral: { en: "FLORAL", jp: "フローラル",   hex: "#ff99cc" },
      woody: